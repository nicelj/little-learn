## 贪婪模式与非贪婪模式讲解

Javascript中的正则贪婪与非贪婪模式的区别是：`被量词修饰的子表达式`的匹配行为。
`贪婪模式`在整个表达式匹配成功的情况下尽可能多的匹配；
`非贪婪模式`在整个表达式匹配成功的前提下，尽可能少的匹配；

一些常见的修饰贪婪模式的量词如下：
```
{x,y} ,  {x,} ,  ? ,  * , 和  +
```

那么非贪婪模式就是在如上`贪婪模式后加上一个?(问号)，就可以变成非贪婪模式的量词；`如下：
```
{x,y}?，{x,}?，??，*?，和 +?
```

### 1. 什么是贪婪模式？

先看如下代码：
```
var str = "longen<p>我是中国人</p>yunxi<p>我是男人</p>boyboy";
// 贪婪模式 匹配所有字符
console.log(str.match(/<p>.*<\/p>/)[0]); 
// <p>我是中国人</p>yunxi<p>我是男人</p>

// 后面加问号，变成非贪婪模式
console.log(str.match(/<p>.*?<\/p>/)[0]); // <p>我是中国人</p>

var str = "longen<p>我是中国人</p>yunxi<p>我是男人</p>boyboy";
// 贪婪模式 匹配所有字符
console.log(str.match(/<p>.*<\/p>/)[0]); 
// <p>我是中国人</p>yunxi<p>我是男人</p>
 
// 后面加问号，变成非贪婪模式
console.log(str.match(/<p>.*?<\/p>/)[0]); // <p>我是中国人</p>
```

第一个console.log使用的是贪婪模式，我们来理解下匹配的基本原理；
```
首先正则是 /<p>.*<\/p>/ 匹配；<p>匹配字符串第一个字符匹配失败，接着往下，
直接匹配到<p>时候，匹配成功，接着把匹配的控制权交给.*，从匹配到的<p>位置开始匹配，一直到</p>之前，
接着把控制权交给</p>，接着在当前位置下往下匹配，因此匹配到</p>，匹配成功；
由于它是贪婪模式，在匹配成功的前提下，仍然会尝试向右往下匹配，因此会匹配到两个<p>标签结束；
但是非贪婪模式，也就是第二个console.log()；他匹配到第一个p标签成功后，它就不会再进行匹配，
因此打印的值为一个p标签的内容了；
```

理解匹配成功前提下的含义： 
上面我们解释了，贪婪模式是要等一个表达式匹配成功后，再往下匹配；
比如我们现在接着再看下们的表达式匹配代码：

```
var str = "longen<p>我是中国人</p>yunxi<p>我是男人</p>boyboy";
// 贪婪模式
console.log(str.match(/<p>.*<\/p>yunxi/)[0]); 
//打印 <p>我是中国人</p>yunxi
```

```
如上代码，打印出一个p标签内容，我们知道.*是贪婪模式匹配，
如果按照上面的解释会打印出2个p标签的内容，因为这里在匹配到p标签后，
会继续匹配后面的yunxi字符串，直到整个表达式匹配成功，才提示匹配成功，
因此当匹配到第一个yunxi后，第一个子表达式匹配成功，接着尝试往右继续匹配，
<p></p>都匹配成功，但是yunxi不会匹配boyboy，所以第二次尝试匹配的子表达式匹配失败，
因此只返回匹配成功后的第一个p标签的内容了；
```

我们现在再来看看非贪婪模式的含义：

如下代码：
```
var str = "longen<p>我是中国人</p>yunxi<p>我是男人</p>boyboy<p>我是中国人2</p>yunxi<p>我是男人</p>boyboy";
// 非贪婪模式1
console.log(str.match(/<p>.*?<\/p>boyboy/)[0]); 
//<p>我是中国人</p>yunxi<p>我是男人</p>boyboy

// 贪婪模式
console.log(str.match(/<p>.*<\/p>yunxi/)[0]); 
//<p>我是中国人</p>yunxi<p>我是男人</p>boyboy<p>我是中国人2</p>yunxi
```

```
我们先看表达式1，/<p>.*?<\/p>boyboy/ 匹配str字符串，首先先匹配到p标签内容；
但是由于boyboy字符串一直没有匹配到，因此会一直尝试往后匹配，直到匹配到boyboy字符串后，
才匹配成功，否则匹配失败；由于它是非贪婪模式，因此这时候它不会再往下进行匹配，所以匹配就结束了；
因此第一个console输出为<p>我是中国人</p>yunxi<p>我是男人</p>boyboy；

我们可以再来看看贪婪模式 第二个console.log()输出的； 
正则表达式 /<p>.*<\/p>yunxi/ 匹配到第一个p标签yunxi后，由于它是贪婪的，
它还想接着向右继续匹配，直到匹配完成后，匹配成功，才结束，
因此把所有p标签后面跟随yunxi的字符串都匹配到，且之间的所有的字符串都被返回；
```